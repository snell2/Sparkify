{"paragraphs":[{"text":"%pyspark\nsc","user":"anonymous","dateUpdated":"2020-04-22T16:17:40+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"<SparkContext master=yarn appName=Zeppelin>\n"}]},"apps":[],"jobName":"paragraph_1587569214190_353209457","id":"20200422-152654_1758077397","dateCreated":"2020-04-22T15:26:54+0000","dateStarted":"2020-04-22T16:17:40+0000","dateFinished":"2020-04-22T16:18:12+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:4178"},{"text":"%pyspark\nimport json\nlog = sc.textFile(\"s3a://snell2-spark/input\")\ndat=log.collect()\n","user":"anonymous","dateUpdated":"2020-04-22T20:00:42+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1587434856399_558956599","id":"20200421-020736_1573001836","dateCreated":"2020-04-21T02:07:36+0000","dateStarted":"2020-04-22T16:18:15+0000","dateFinished":"2020-04-22T16:18:20+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4179"},{"text":"%pyspark\nfor dic in dat:\n    data=json.loads(dic)\n    #print(data['song'])\n    ","user":"anonymous","dateUpdated":"2020-04-22T20:00:51+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1587568587330_-1245807479","id":"20200422-151627_2131895663","dateCreated":"2020-04-22T15:16:27+0000","dateStarted":"2020-04-22T18:48:20+0000","dateFinished":"2020-04-22T18:48:20+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4180"},{"text":"%pyspark\n\n#mapper code\ns_lst=[]\na_lst=[]\nfor dic in dat:\n    data=json.loads(dic)\n    s=data['song']\n    a=data['artist']\n    s_lst.append([s,1])\n    a_lst.append([a,1])\n    ","user":"anonymous","dateUpdated":"2020-04-22T20:00:56+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1587575943464_925660752","id":"20200422-171903_1166458038","dateCreated":"2020-04-22T17:19:03+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:4782","dateFinished":"2020-04-22T17:50:45+0000","dateStarted":"2020-04-22T17:50:45+0000","results":{"code":"SUCCESS","msg":[]}},{"text":"%pyspark\n#reducer code\ndef reducer(lst):\n    dict={}\n    list=[]\n    for l in lst:\n        if l[0] not in dict:\n            dict[l[0]]=1\n        else: dict[l[0]]+=1\n    \n    for key,values in dict.items():\n        if key == None:\n            continue\n        else:\n            list.append([key,values])\n    \n    list = sorted (list, key=lambda x:x[1],reverse=True)\n    #list.pop(0)\n    return list\n\n\nsong=[]\nartist=[]\nartist=reducer(a_lst)\nsong=reducer(s_lst)\n","user":"anonymous","dateUpdated":"2020-04-22T20:01:07+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1587576024170_2105089949","id":"20200422-172024_776923201","dateCreated":"2020-04-22T17:20:24+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:4864","dateFinished":"2020-04-22T18:05:11+0000","dateStarted":"2020-04-22T18:05:11+0000","results":{"code":"SUCCESS","msg":[]}},{"text":"%pyspark\nartist[:20]","user":"anonymous","dateUpdated":"2020-04-22T20:12:59+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1587575810297_-1812860078","id":"20200422-171650_362545591","dateCreated":"2020-04-22T17:16:50+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4184","dateFinished":"2020-04-22T20:12:59+0000","dateStarted":"2020-04-22T20:12:59+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[[u'Coldplay', 58], [u'Kings Of Leon', 55], [u'Dwight Yoakam', 38], [u'The Black Keys', 36], [u'Muse', 35], [u'Florence + The Machine', 35], [u'Jack Johnson', 35], [u'Bj\\xc3\\x83\\xc2\\xb6rk', 33], [u'John Mayer', 31], [u'The Killers', 31], [u'Radiohead', 30], [u'OneRepublic', 30], [u'Alliance Ethnik', 30], [u'Justin Bieber', 29], [u'Linkin Park', 28], [u'Metallica', 27], [u'Eminem', 26], [u'Train', 25], [u'Taylor Swift', 23], [u'Beyonc\\xc3\\x83\\xc2\\xa9', 23]]\n"}]}},{"text":"%pyspark\nsong[:20]","user":"anonymous","dateUpdated":"2020-04-22T20:13:03+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1587576089410_1232734978","id":"20200422-172129_835214076","dateCreated":"2020-04-22T17:21:29+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:5054","dateFinished":"2020-04-22T20:13:03+0000","dateStarted":"2020-04-22T20:13:03+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"[[u\"You're The One\", 37], [u'Undo', 28], [u'Revelry', 27], [u'Sehr kosmisch', 21], [u'Horn Concerto No. 4 in E flat K495: II. Romance (Andante cantabile)', 19], [u'Canada', 17], [u'Secrets', 17], [u'Dog Days Are Over (Radio Edit)', 16], [u'Invalid', 14], [u'Fireflies', 14], [u'Repr\\xc3\\x83\\xc2\\xa9sente', 14], [u'Home', 13], [u'Somebody To Love', 13], [u'Hey_ Soul Sister', 12], [u'Yellow', 12], [u'Sincerit\\xc3\\x83\\xc2\\xa9 Et Jalousie', 11], [u'Pursuit Of Happiness (nightmare)', 10], [u'The Gift', 10], [u'Gears', 10], [u'OMG', 10]]\n"}]}},{"text":"%pyspark\nfrom pyspark.sql.types import *\nsch = StructType([StructField(\"Songs\", StringType()),StructField(\"Count\", IntegerType())])\nsong_df = spark.createDataFrame(song,schema=sch)\n\nsch1 = StructType([StructField(\"Artists\", StringType()),StructField(\"Count\", IntegerType())])\nartist_df = spark.createDataFrame(artist,schema=sch1)\n","user":"anonymous","dateUpdated":"2020-04-22T20:01:38+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1587582477410_-902186998","id":"20200422-190757_1680876355","dateCreated":"2020-04-22T19:07:57+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:7858","dateFinished":"2020-04-22T19:49:46+0000","dateStarted":"2020-04-22T19:49:46+0000","results":{"code":"SUCCESS","msg":[]}},{"text":"%pyspark\nsong_df.show()","user":"anonymous","dateUpdated":"2020-04-22T19:49:29+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1587582617658_494106799","id":"20200422-191017_1845278285","dateCreated":"2020-04-22T19:10:17+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:8066","dateFinished":"2020-04-22T19:49:29+0000","dateStarted":"2020-04-22T19:49:29+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+-----+\n|               Songs|Count|\n+--------------------+-----+\n|      You're The One|   37|\n|                Undo|   28|\n|             Revelry|   27|\n|       Sehr kosmisch|   21|\n|Horn Concerto No....|   19|\n|              Canada|   17|\n|             Secrets|   17|\n|Dog Days Are Over...|   16|\n|             Invalid|   14|\n|           Fireflies|   14|\n|       ReprÃÂ©sente|   14|\n|                Home|   13|\n|    Somebody To Love|   13|\n|    Hey_ Soul Sister|   12|\n|              Yellow|   12|\n|SinceritÃÂ© Et J...|   11|\n|Pursuit Of Happin...|   10|\n|            The Gift|   10|\n|               Gears|   10|\n|                 OMG|   10|\n+--------------------+-----+\nonly showing top 20 rows\n\n"}]}},{"text":"%pyspark\nartist_df.show()","user":"anonymous","dateUpdated":"2020-04-22T19:49:48+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1587584949296_2016551944","id":"20200422-194909_2089925439","dateCreated":"2020-04-22T19:49:09+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:8863","dateFinished":"2020-04-22T19:49:48+0000","dateStarted":"2020-04-22T19:49:48+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+-----+\n|             Artists|Count|\n+--------------------+-----+\n|            Coldplay|   58|\n|       Kings Of Leon|   55|\n|       Dwight Yoakam|   38|\n|      The Black Keys|   36|\n|                Muse|   35|\n|Florence + The Ma...|   35|\n|        Jack Johnson|   35|\n|            BjÃÂ¶rk|   33|\n|          John Mayer|   31|\n|         The Killers|   31|\n|           Radiohead|   30|\n|         OneRepublic|   30|\n|     Alliance Ethnik|   30|\n|       Justin Bieber|   29|\n|         Linkin Park|   28|\n|           Metallica|   27|\n|              Eminem|   26|\n|               Train|   25|\n|        Taylor Swift|   23|\n|          BeyoncÃÂ©|   23|\n+--------------------+-----+\nonly showing top 20 rows\n\n"}]}},{"text":"%pyspark\nsong_df.write.save(\"s3://snell2-spark/output/songs\")","user":"anonymous","dateUpdated":"2020-04-22T19:50:32+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1587583592374_63583927","id":"20200422-192632_1856215985","dateCreated":"2020-04-22T19:26:32+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:8250","dateFinished":"2020-04-22T19:50:33+0000","dateStarted":"2020-04-22T19:50:32+0000","results":{"code":"SUCCESS","msg":[]}},{"text":"%pyspark\nartist_df.write.save(\"s3://snell2-spark/output/artist\")\n","user":"anonymous","dateUpdated":"2020-04-22T19:50:34+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1587585002531_460724372","id":"20200422-195002_1079829045","dateCreated":"2020-04-22T19:50:02+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:9072","dateFinished":"2020-04-22T19:50:35+0000","dateStarted":"2020-04-22T19:50:34+0000","results":{"code":"SUCCESS","msg":[]}}],"name":"Sparkify 6","id":"2F5GH4SJZ","noteParams":{},"noteForms":{},"angularObjects":{"md:shared_process":[],"python:shared_process":[],"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}